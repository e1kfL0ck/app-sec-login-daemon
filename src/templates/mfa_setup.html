{% extends "base.html" %}
{% block content %}

<h2>MFA setup</h2>

{% if error %}
<p style="color:red;">{{ error }}</p>
{% endif %}

<p>Scan the QR code below with your authenticator app (e.g., Google Authenticator, Authy) and enter the OTP generated by
  the app to complete the setup.</p>
<p>Alternatively, you can manually enter the totp secret into your authenticator app.</p>
<br>
<img src="{{ qr }}" alt="QR code">
<br>
<p>totp secret: {{ secret }}</p>
<br>
<form method="post" action="{{ url_for('mfa.confirm') }}">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
  <input type="hidden" name="secret" value="{{ secret }}">
  <p>In order to complete the setup, please enter the one time password generated by your authenticator app.</p>
  <label>One time password: <input name="otp" required></label>
  <button type="submit">Submit</button>
</form>
{% endblock %}